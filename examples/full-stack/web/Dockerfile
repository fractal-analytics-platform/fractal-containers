FROM node:25-alpine3.23

ARG FRACTAL_WEB_VERSION


ENV NODE_MAJOR_VERSION=20

RUN wget -qO- "https://github.com/fractal-analytics-platform/fractal-web/releases/download/v${FRACTAL_WEB_VERSION}/node-${NODE_MAJOR_VERSION}-fractal-web-v${FRACTAL_WEB_VERSION}.tar.gz" | tar -xz

ENV FRACTAL_SERVER_HOST=http://slurm:8000
ENV PUBLIC_FRACTAL_DATA_URL=http://localhost:3000/data
ENV PUBLIC_FRACTAL_VIZARR_VIEWER_URL=http://localhost:3000/data/vizarr
# ENV PUBLIC_FRACTAL_FEATURE_EXPLORER_URL=http://localhost:8501
ENV PUBLIC_FRACTAL_ADMIN_SUPPORT_EMAIL=
ENV PUBLIC_OAUTH_CLIENT_NAME=
ENV AUTH_COOKIE_DOMAIN=
ENV AUTH_COOKIE_SECURE=false
ENV ORIGIN=http://localhost:5173
ENV PORT=5173
ENV LOG_LEVEL_CONSOLE=info
ENV FRACTAL_RUNNER_BACKEND=slurm_sudo
ENV FRACTAL_DEFAULT_GROUP_NAME=All
# Running
CMD ["node", "build"]
